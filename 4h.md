## h4 Julkisen palvelimen ja nimen vuokraaminen

Karvinen, T. 2022. Linux Palvelimet 2022. Luettavissa: https://terokarvinen.com/2021/linux-palvelimet-ict4tn021-3018/

#### z) Tiivistelmät artikkeleista


Karvinen. T. 2017. First Steps on a New Virtual Private Server – an Example on DigitalOcean and Ubuntu 16.04 LTS. Luettavissa: https://terokarvinen.com/2017/first-steps-on-a-new-virtual-private-server-an-example-on-digitalocean/?fromSearch=first%20steps

Artikkeli, jossa ohjeistetaan julkisen pilven vuokraamiseen. Opiskelijan kannattaa ottaa GitHub Education -paketti, jonka kautta saa hyviä tarjouksia esimerkiksi DigitalOceaniin. Ensiarvoisen tärkeää on luoda aina hyviä salasanoja. Kun serveri on asennettu, on laitettava palomuuri. Tehdään reikä ssh-palvelimelle. Artikkelin lopussa käsiteltiin nimipalvelinta, esimerkkinä Namecheap, josta voi vuokrata nimen palvelimelle.
    
Karvinen, T. 2018. Name Based Virtual Hosts on Apache – Multiple Websites to Single IP Address. Luettavissa: https://terokarvinen.com/2018/name-based-virtual-hosts-on-apache-multiple-websites-to-single-ip-address/?fromSearch=name%20based%20virtual

Artikkelissa käsitellään, miten Apachelle asennetaan virtuaalihost. Samalle palvelimelle pystyy asettamaan monta eri domainnimeä. 


#### a) Pilvi. Vuokraa ja asenna oma julkinen palvelin Internetiin. Vuokraa nimi osoittamaan siihen.

Vuokrasin julkisen pilven yritykseltä DigitalOcean. Kirjauduin sivustolle GitHubEducation-paketin tarjouspaketin kautta, jolloin sain 100 credittiä (euroa) käyttööni. Näin ei tarvitse käyttää omaa rahaa palvelun ylläpitoon. 

Valitsin ylävalikosta New Droplet. Valitsin halvimman mahdollisen prosessorin. En ottanut mitään ylimääräisiä paketteja tai palveluita. Kuten alla olevasta kuvasta käy ilmi, valitsin Debian 11 x64. Kaupungiksi valitsin Frankfurtin. Autentikointitavaksi salasanan.


![](images/oceanImage.png)

Annoin palvelimelle nimeksi linuxs, ja painoin ok. Luominen kesti muutamia sekunteja. Alla kuva onnistuneesta luomisesta.



![](images/oceanOK.png)

Seuraavaksi vuokrasin nimen palvelimelle. Tein vuokrauden palvelun NameCheap kautta. GitHubEducation-paketilla sain nimen vuokrauksen ilmaiseksi vuoden ajaksi.

![](images/claimDomain.png)

Etsin ensiksi nimipalvelusta nimeä nurmi.me. Se oli jo käytössä. Kokeilin nurmis.me, ja tämä oli vapaana.


![](images/nurmisOK.png)

Vuokrasin tämän nimen onnistuneesti. 

![](images/confirmDomain.png)

Vuokrauksen jälkeen menin muokkaamaan asetuksia, jotta sain uuden nimeni osoittamaan oikeaan palvelimeen. Polku oli Dashboard –-> nurmis.me --> Manage –-> Advanced DNS. Vaihdoin oikean ip-osoitteen, kuten alla olevasta kuvasta näkyy. Ip-osoitteen sain selville DigitalOceanista palvelimeni tiedoista.

![](images/domainSettingOK.png)



#### d) Suuri muuri. Suojaa palvelin tulimuurilla. Muista ensin reikä ssh-palvelimelle.

Otin yhteyttä asentamaani serveriin terminaalin kautta komennolla

    $ ssh käyttäjänimitähän@ip-osoitetähän

ja syötin serverin salasanan.

![](images/sshOK.png)

Seuraavaksi asensin ufw:n 

UFW eli Uncomplicated Firewall on työkalu Netfilter-palomuurin hallintaan.

    $ sudo apt-get update
    $ sudo apt-get install ufw
    
Asennus onnistui hyvin. Tämän jälkeen avasin ssh:lle portin palomuurista komennolla

    $ sudo ufw allow 22/tcp


Näin palvelimeen saadaan etäyhteys. Sitten aktivoin palomuurin käyttöön komennolla

    $ sudo ufw enable
    
![](images/tulimuuriOK.png)
    
Kun palomuuri on aktivoitu, se estää kaiken liikenteen tulon, ellei jollekin ole varta vasten avattu porttia. 

Tämän jälkeen tein uuden käyttäjän ja lisäsin sen sudo-ryhmään, jolloin se saa oikeuden ajaa sudo-komentoja: 

    $ sudo adduser käyttäjänimitähän
    $ sudo adduser käyttäjänimitähän sudo

![](images/addUser.png)

Kirjauduin omalta koneelta palvelimelle komennolla

    $ ssh sonsku@nurmis.me
    
Tämä onnistui, joten poistin rootin käyttäjätunnukset käytöstä komennolla

    $ sudo usermod –lock root

![](images/Lockusermod.png)
    
Sain seuraavanlaisen ilmoituksen. En ole täysin varma, onnistuiko käytöstä pois otto...?


#### e) Served. Laita koneellesi Apache-weppipalvelin. Korvaa testisivu. Laita käyttäjän kotisivut toimimaan. Kokeile eri koneelta, esim. kännykällä, että sivut toimivat. Vinkki: tee kotisivut normaalina käyttäjänä public_html/ alle.

Asensin apachen komennolla

    $ sudo apt-get install apache2
    
Se onnistui hyvin. Sitten avasin palomuurista portin 80 komennolla

    $ sudo ufw allow 80
    
Menin sivustolleni osoitteeseen nurmis.me ja sain apachen oletussivun - se siis toimi.

![](images/nurmismeOK.png)





#### f) Päivitys. Päivitä palvelimesi kaikki ohjelmat.

Päivitin palvelimeni kaikki ohjelmat komennoilla

    $ sudo apt-get update
    $ sudo apt-get upgrade
    $ sudo apt-get dist-upgrade



#### g) Rosvot porteilla. Etsi lokeistasi merkkejä murtautumisyrityksistä ja analysoi ne.

Yritin etsiä lokitietoja komennolla

        $ sudo

mutta sain vain viime viikkoisia lokitietoja. Yksi oli tältä viikolta. Olin käyttäjänä sonja, en uutena tekemänäni käyttäjänä. Yritin vaihtaa käyttäjää komennolla

        $ su käyttäjänimitähän

mutta sain virheilmoituksen, että käyttäjää ei löytyisi. Se ei oikein voisi pitää paikkaansa, koska loin uuden käyttäjän onnistuneesti, ja tein sillä komentoja onnistuneesti aikaisemmin...


